---
layout: post
title: Bit Golf – FPGA VGA Game
description: Designed and implemented an FPGA-based mini golf video game with real-time motion control using a Wii Nunchuck, VGA graphics rendering, and modular VHDL architecture on an UPduino FPGA.
skills: 
  - VHDL
  - FPGA Design
  - VGA Graphics
  - Finite State Machines
  - I2C Communication
  - Embedded Systems
  - Hardware/Software Co-Design
main-image: /fpga.png
---

# Project Overview

**Bit Golf** is a hardware-accelerated mini golf game implemented entirely on an FPGA. The game renders real-time graphics to a VGA display and uses a **Wii Nunchuck** as a motion-based controller to determine shot direction, club selection, and swing strength.

The system was designed using modular **VHDL components**, emphasizing clarity, reusability, and precise timing control across graphics, input handling, and game logic.

**Starting Screen**
{% include image-gallery.html images="bit-golf.png" height=500" %}


**Game Screen**
{% include image-gallery.html images="game_screen.jpg" height="300" %}


**End Screen**
{% include image-gallery.html images="end_screen.jpg" height="300" %}

---

# System Architecture

The game is composed of multiple interacting hardware components, each responsible for a specific subsystem.

{% include image-gallery.html images="block-diagram.png" height="350" %}

### Major Components
* **Nunchuck Interface (I2C)**
* **Game Logic FSM**
* **VGA Controller**
* **Tile-Based Graphics Engine**
* **Overlay Renderers (Ball, Club, Direction)**
* **Clock Generation (PLL)**

---

# Input Device: Wii Nunchuck

The Wii Nunchuck communicates with the FPGA over **I2C** and provides:
* Joystick X/Y position
* 3-axis accelerometer data
* Two buttons (`C` and `Z`)

### I2C Communication
* Handshake sequence: `F0 → 55 → FB → 00`
* Data read loop retrieves 6 bytes per transaction
* Custom FSM manages `ena` and `busy` signals from the `i2c_master` module

The accelerometer’s Y-axis is used to determine **swing strength**, while joystick inputs control **club selection** and **shot direction**.

---

# Game Logic & State Machines

The game operates using a **multi-state finite state machine**:

### Game States
* **Start Screen** – Displays title and instructions
* **Play State** – Active gameplay
* **End Screen** – Win screen with replay option

State transitions are triggered using the Nunchuck buttons:
* `Z` → Start game
* `C` → Return to start screen

### Ball Physics
* Shot distance depends on:
  * Selected club (Driver, Iron, Putter)
  * Swing acceleration (Low / Medium / High)
* Directional movement limited to cardinal directions
* Screen wrapping implemented on top/left edges

---

# VGA Graphics System

The VGA display operates at **640×480 resolution**, driven by a **25.125 MHz pixel clock** generated via PLL.

## Tile-Based Rendering
* Screen divided into **16×16 pixel tiles**
* Total grid: **40 × 30 tiles**
* Tile addressing generated by dividing pixel row/column counters

This approach significantly reduced memory usage while maintaining clear visuals.

---

# Display Components & Overlay Hierarchy

Multiple rendering modules contribute to the final VGA output, layered by priority:

1. **Golf Ball Renderer** – Highest priority
2. **Club Display** – Bottom-left UI indicator
3. **Direction Arrow** – Displayed next to ball
4. **Pixel Tile Background** – Course, menus, screens

Each module independently outputs RGB values, allowing clean compositing without software blending.

---

# Course & Graphics Design

* Screens designed using **Piskel**
* Converted into tile maps via Python scripts
* Stored as ROM-style lookup tables in VHDL
* Course includes:
  * Putting green
  * Sand traps
  * Water hazard
  * Hole detection region

Despite limited LUT availability, the tile size was optimized to balance resolution and memory constraints.

---

# Results & Gameplay

* Fully playable mini golf course
* Motion-based swing detection
* Smooth VGA output at stable frame timing
* Average playthrough: **par 4**
* Stroke count ranges from **3 to 20+**

{% include youtube-video.html id="dgkq-1HJiLQ" autoplay="false" %}

---

# Skills Demonstrated

* **FPGA Design**: Modular VHDL architecture with clean component interfaces
* **Digital Communication**: I2C protocol implementation
* **Real-Time Graphics**: VGA signal generation and layered rendering
* **State Machines**: Game logic, I2C control, and rendering control
* **System Integration**: Clock domain management and component synchronization

---

# Limitations & Future Improvements

* Add diagonal shot directions (intercardinal movement)
* Increase graphical resolution (8×8 tiles)
* Add multiple courses
* Improve collision detection precision
* Resolve minor VGA artifact lines observed at lower screen regions

---

# Project Team

* **Brian Liau** – System Integration & Game Logic  
  Responsible for VGA integration, ball physics, overlay priority handling, and full system debugging.

* **Jet Yotsuuye** – Nunchuck Interface  
  Implemented and debugged the I2C-based Wii Nunchuck controller interface.

* **Hunter Niimi** – Graphics & Memory Optimization  
  Designed tile-based graphics and optimized memory usage.

* **Brady Kamali** – Physics & Gameplay Tuning  
  Developed swing-to-distance mapping and club behavior logic.

---

# Files

All source code and design files are available here:  
[GitHub Repository – Bit Golf](https://github.com/Jet4stream/Minigolf-Project)

---



